# Course Management Platform

РџР»Р°С‚С„РѕСЂРјР° РґР»СЏ СѓРїСЂР°РІР»РµРЅРёСЏ РєСѓСЂСЃР°РјРё СЃ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚СЊСЋ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ (Quiz) РЅР° Spring Boot.

## Р¤СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚СЊ

### РћСЃРЅРѕРІРЅС‹Рµ РІРѕР·РјРѕР¶РЅРѕСЃС‚Рё
- вњ… Р РµРіРёСЃС‚СЂР°С†РёСЏ Рё Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ (JWT)
- вњ… РЈРїСЂР°РІР»РµРЅРёРµ РєСѓСЂСЃР°РјРё (СЃРѕР·РґР°РЅРёРµ, РїСЂРѕСЃРјРѕС‚СЂ, СЂРµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ)
- вњ… РЎРѕР·РґР°РЅРёРµ Рё РїСЂРѕС…РѕР¶РґРµРЅРёРµ С‚РµСЃС‚РѕРІ (Quiz)
- вњ… Р Р°Р·РіСЂР°РЅРёС‡РµРЅРёРµ РґРѕСЃС‚СѓРїР° РїРѕ СЂРѕР»СЏРј (STUDENT, TEACHER, ADMIN)
- вњ… РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРѕРµ РѕС†РµРЅРёРІР°РЅРёРµ С‚РµСЃС‚РѕРІ
- вњ… РћС‚СЃР»РµР¶РёРІР°РЅРёРµ РїРѕРїС‹С‚РѕРє РїСЂРѕС…РѕР¶РґРµРЅРёСЏ С‚РµСЃС‚РѕРІ
- вњ… REST API СЃ РґРѕРєСѓРјРµРЅС‚Р°С†РёРµР№ Swagger
- вњ… РњРѕРЅРёС‚РѕСЂРёРЅРі С‡РµСЂРµР· Spring Actuator

### Р РѕР»Рё РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№
- **STUDENT** - РјРѕР¶РµС‚ РїСЂРѕСЃРјР°С‚СЂРёРІР°С‚СЊ РєСѓСЂСЃС‹ Рё РїСЂРѕС…РѕРґРёС‚СЊ С‚РµСЃС‚С‹
- **TEACHER** - РјРѕР¶РµС‚ СЃРѕР·РґР°РІР°С‚СЊ РєСѓСЂСЃС‹ Рё С‚РµСЃС‚С‹, РїСЂРѕСЃРјР°С‚СЂРёРІР°С‚СЊ СЂРµР·СѓР»СЊС‚Р°С‚С‹ СЃС‚СѓРґРµРЅС‚РѕРІ
- **ADMIN** - РїРѕР»РЅС‹Р№ РґРѕСЃС‚СѓРї РєРѕ РІСЃРµРј С„СѓРЅРєС†РёСЏРј

### РўРёРїС‹ РІРѕРїСЂРѕСЃРѕРІ РІ С‚РµСЃС‚Р°С…
- **SINGLE_CHOICE** - РІС‹Р±РѕСЂ РѕРґРЅРѕРіРѕ РїСЂР°РІРёР»СЊРЅРѕРіРѕ РѕС‚РІРµС‚Р°
- **MULTIPLE_CHOICE** - РІС‹Р±РѕСЂ РЅРµСЃРєРѕР»СЊРєРёС… РїСЂР°РІРёР»СЊРЅС‹С… РѕС‚РІРµС‚РѕРІ
- **TEXT** - С‚РµРєСЃС‚РѕРІС‹Р№ РѕС‚РІРµС‚ (С‚СЂРµР±СѓРµС‚ СЂСѓС‡РЅРѕР№ РїСЂРѕРІРµСЂРєРё)

## РўРµС…РЅРѕР»РѕРіРёС‡РµСЃРєРёР№ СЃС‚РµРє

- **Java 17**
- **Spring Boot 3.2.0**
- **Spring Security** (JWT Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЏ)
- **Spring Data JPA** (Hibernate)
- **PostgreSQL** (Р±Р°Р·Р° РґР°РЅРЅС‹С…)
- **Flyway** (РјРёРіСЂР°С†РёРё Р‘Р”)
- **MapStruct** (РјР°РїРїРёРЅРі DTO)
- **SpringDoc OpenAPI** (Swagger РґРѕРєСѓРјРµРЅС‚Р°С†РёСЏ)
- **Spring Actuator** (РјРѕРЅРёС‚РѕСЂРёРЅРі)
- **Lombok** (РіРµРЅРµСЂР°С†РёСЏ РєРѕРґР°)

## РўСЂРµР±РѕРІР°РЅРёСЏ

- Java 17 РёР»Рё РІС‹С€Рµ
- PostgreSQL 12 РёР»Рё РІС‹С€Рµ
- Maven 3.6 РёР»Рё РІС‹С€Рµ

## РќР°СЃС‚СЂРѕР№РєР° Рё Р·Р°РїСѓСЃРє

### 1. РќР°СЃС‚СЂРѕР№РєР° Р±Р°Р·С‹ РґР°РЅРЅС‹С…

РЎРѕР·РґР°Р№С‚Рµ Р±Р°Р·Сѓ РґР°РЅРЅС‹С… PostgreSQL:

```sql
CREATE DATABASE course_platform;
CREATE USER course_user WITH PASSWORD 'course_password';
GRANT ALL PRIVILEGES ON DATABASE course_platform TO course_user;
```

### 2. РќР°СЃС‚СЂРѕР№РєР° РєРѕРЅС„РёРіСѓСЂР°С†РёРё

РћР±РЅРѕРІРёС‚Рµ С„Р°Р№Р» `src/main/resources/application.yml`:

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/course_platform
    username: course_user
    password: course_password
```

### 3. РЎР±РѕСЂРєР° Рё Р·Р°РїСѓСЃРє

```bash
# РЎР±РѕСЂРєР° РїСЂРѕРµРєС‚Р°
mvn clean compile

# Р—Р°РїСѓСЃРє РїСЂРёР»РѕР¶РµРЅРёСЏ
mvn spring-boot:run
```

РџСЂРёР»РѕР¶РµРЅРёРµ Р±СѓРґРµС‚ РґРѕСЃС‚СѓРїРЅРѕ РїРѕ Р°РґСЂРµСЃСѓ: http://localhost:8080

### 4. Р”РѕСЃС‚СѓРї Рє РґРѕРєСѓРјРµРЅС‚Р°С†РёРё API

- **Swagger UI**: http://localhost:8080/swagger-ui.html
- **OpenAPI JSON**: http://localhost:8080/v3/api-docs

### 5. РњРѕРЅРёС‚РѕСЂРёРЅРі

- **Health Check**: http://localhost:8080/actuator/health
- **Application Info**: http://localhost:8080/actuator/info
- **Metrics**: http://localhost:8080/actuator/metrics

## РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ API

### РСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ Postman

1. РРјРїРѕСЂС‚РёСЂСѓР№С‚Рµ РєРѕР»Р»РµРєС†РёСЋ `Course_Platform_API.postman_collection.json` РІ Postman
2. РЎРѕР·РґР°Р№С‚Рµ РѕРєСЂСѓР¶РµРЅРёРµ СЃРѕ СЃР»РµРґСѓСЋС‰РёРјРё РїРµСЂРµРјРµРЅРЅС‹РјРё:
   - `baseUrl`: http://localhost:8080
3. Р’С‹РїРѕР»РЅРёС‚Рµ Р·Р°РїСЂРѕСЃС‹ РІ СЃР»РµРґСѓСЋС‰РµРј РїРѕСЂСЏРґРєРµ:
   1. Р РµРіРёСЃС‚СЂР°С†РёСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ (Teacher Рё Student)
   2. РђСѓС‚РµРЅС‚РёС„РёРєР°С†РёСЏ
   3. РЎРѕР·РґР°РЅРёРµ РєСѓСЂСЃР°
   4. РЎРѕР·РґР°РЅРёРµ С‚РµСЃС‚Р°
   5. РџСЂРѕС…РѕР¶РґРµРЅРёРµ С‚РµСЃС‚Р°

### РўРµСЃС‚РѕРІС‹Рµ РґР°РЅРЅС‹Рµ

Р”Р»СЏ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ СЃРѕР·РґР°Р№С‚Рµ РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ С‡РµСЂРµР· API СЂРµРіРёСЃС‚СЂР°С†РёРё РёР»Рё РёСЃРїРѕР»СЊР·СѓР№С‚Рµ РіРѕС‚РѕРІС‹Рµ:
- **admin@platform.edu** / **password** (ADMIN)
- **teacher@platform.edu** / **password** (TEACHER)  
- **student@platform.edu** / **password** (STUDENT)

**РџСЂРёРјРµС‡Р°РЅРёРµ:** РўРµСЃС‚РѕРІС‹Рµ РїРѕР»СЊР·РѕРІР°С‚РµР»Рё СЃРѕР·РґР°СЋС‚СЃСЏ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїСЂРё РїРµСЂРІРѕРј Р·Р°РїСѓСЃРєРµ С‡РµСЂРµР· API СЂРµРіРёСЃС‚СЂР°С†РёСЋ.

## РЎС‚СЂСѓРєС‚СѓСЂР° РїСЂРѕРµРєС‚Р°

```
src/main/java/edu/platform/
в”њв”Ђв”Ђ config/           # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ (Security, OpenAPI)
в”њв”Ђв”Ђ controller/       # REST РєРѕРЅС‚СЂРѕР»Р»РµСЂС‹
в”њв”Ђв”Ђ dto/             # DTO РєР»Р°СЃСЃС‹ (request/response)
в”њв”Ђв”Ђ entity/          # JPA СЃСѓС‰РЅРѕСЃС‚Рё
в”њв”Ђв”Ђ exception/       # РСЃРєР»СЋС‡РµРЅРёСЏ Рё РѕР±СЂР°Р±РѕС‚С‡РёРєРё
в”њв”Ђв”Ђ mapper/          # MapStruct РјР°РїРїРµСЂС‹
в”њв”Ђв”Ђ repository/      # JPA СЂРµРїРѕР·РёС‚РѕСЂРёРё
в”њв”Ђв”Ђ security/        # РљРѕРјРїРѕРЅРµРЅС‚С‹ Р±РµР·РѕРїР°СЃРЅРѕСЃС‚Рё
в”њв”Ђв”Ђ service/         # Р‘РёР·РЅРµСЃ-Р»РѕРіРёРєР°
в””в”Ђв”Ђ util/            # РЈС‚РёР»РёС‚С‹ (JWT)
```

## РћСЃРЅРѕРІРЅС‹Рµ СЌРЅРґРїРѕРёРЅС‚С‹ API

### РђСѓС‚РµРЅС‚РёС„РёРєР°С†РёСЏ
- `POST /api/auth/register` - Р РµРіРёСЃС‚СЂР°С†РёСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ
- `POST /api/auth/login` - Р’С…РѕРґ РІ СЃРёСЃС‚РµРјСѓ

### РџРѕР»СЊР·РѕРІР°С‚РµР»Рё
- `GET /api/users/me` - РРЅС„РѕСЂРјР°С†РёСЏ Рѕ С‚РµРєСѓС‰РµРј РїРѕР»СЊР·РѕРІР°С‚РµР»Рµ
- `GET /api/users/{id}` - РРЅС„РѕСЂРјР°С†РёСЏ Рѕ РїРѕР»СЊР·РѕРІР°С‚РµР»Рµ РїРѕ ID

### РљСѓСЂСЃС‹
- `POST /api/courses` - РЎРѕР·РґР°РЅРёРµ РєСѓСЂСЃР° (TEACHER, ADMIN)
- `GET /api/courses` - РЎРїРёСЃРѕРє РІСЃРµС… РєСѓСЂСЃРѕРІ
- `GET /api/courses/{id}` - Р”РµС‚Р°Р»Рё РєСѓСЂСЃР°
- `PUT /api/courses/{id}` - РћР±РЅРѕРІР»РµРЅРёРµ РєСѓСЂСЃР° (РІР»Р°РґРµР»РµС†)
- `DELETE /api/courses/{id}` - РЈРґР°Р»РµРЅРёРµ РєСѓСЂСЃР° (РІР»Р°РґРµР»РµС†)
- `GET /api/courses/my` - РњРѕРё РєСѓСЂСЃС‹ (TEACHER)

### РўРµСЃС‚С‹
- `POST /api/quizzes` - РЎРѕР·РґР°РЅРёРµ С‚РµСЃС‚Р° (TEACHER, ADMIN)
- `GET /api/quizzes/course/{courseId}` - РўРµСЃС‚С‹ РєСѓСЂСЃР°
- `GET /api/quizzes/{id}` - Р”РµС‚Р°Р»Рё С‚РµСЃС‚Р°
- `POST /api/quizzes/{id}/start` - РќР°С‡Р°С‚СЊ РїСЂРѕС…РѕР¶РґРµРЅРёРµ С‚РµСЃС‚Р° (STUDENT)
- `POST /api/quizzes/submit` - РћС‚РїСЂР°РІРёС‚СЊ РѕС‚РІРµС‚С‹ (STUDENT)
- `GET /api/quizzes/attempts/my` - РњРѕРё РїРѕРїС‹С‚РєРё (STUDENT)
- `GET /api/quizzes/{id}/attempts` - РџРѕРїС‹С‚РєРё С‚РµСЃС‚Р° (TEACHER)

## РћСЃРѕР±РµРЅРЅРѕСЃС‚Рё СЂРµР°Р»РёР·Р°С†РёРё

### РўСЂР°РЅР·Р°РєС†РёРё
- РСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ СЂР°Р·Р»РёС‡РЅС‹Рµ СѓСЂРѕРІРЅРё РёР·РѕР»СЏС†РёРё (`READ_COMMITTED`, `REPEATABLE_READ`, `SERIALIZABLE`)
- Р”РµРјРѕРЅСЃС‚СЂРёСЂСѓРµС‚СЃСЏ СЂР°Р±РѕС‚Р° СЃ `Propagation.REQUIRED`, `Propagation.REQUIRES_NEW`
- РћРїС‚РёРјРёСЃС‚РёС‡РµСЃРєРёРµ Р±Р»РѕРєРёСЂРѕРІРєРё С‡РµСЂРµР· `@Version` РІ СЃСѓС‰РЅРѕСЃС‚Рё Course
- РџРµСЃСЃРёРјРёСЃС‚РёС‡РµСЃРєРёРµ Р±Р»РѕРєРёСЂРѕРІРєРё С‡РµСЂРµР· `@Lock` РІ СЂРµРїРѕР·РёС‚РѕСЂРёСЏС…

### Р‘РµР·РѕРїР°СЃРЅРѕСЃС‚СЊ
- JWT С‚РѕРєРµРЅС‹ РґР»СЏ Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёРё
- Р Р°Р·РіСЂР°РЅРёС‡РµРЅРёРµ РґРѕСЃС‚СѓРїР° РїРѕ СЂРѕР»СЏРј С‡РµСЂРµР· `@PreAuthorize`
- Р—Р°С‰РёС‚Р° РѕС‚ CSRF Р°С‚Р°Рє
- CORS РєРѕРЅС„РёРіСѓСЂР°С†РёСЏ

### Р’Р°Р»РёРґР°С†РёСЏ
- Р’Р°Р»РёРґР°С†РёСЏ РІС…РѕРґРЅС‹С… РґР°РЅРЅС‹С… С‡РµСЂРµР· Bean Validation
- Р“Р»РѕР±Р°Р»СЊРЅР°СЏ РѕР±СЂР°Р±РѕС‚РєР° РѕС€РёР±РѕРє С‡РµСЂРµР· `@ControllerAdvice`
- Р”РµС‚Р°Р»СЊРЅС‹Рµ СЃРѕРѕР±С‰РµРЅРёСЏ РѕР± РѕС€РёР±РєР°С… РІР°Р»РёРґР°С†РёРё

### Р›РѕРіРёСЂРѕРІР°РЅРёРµ
- РЎС‚СЂСѓРєС‚СѓСЂРёСЂРѕРІР°РЅРЅРѕРµ Р»РѕРіРёСЂРѕРІР°РЅРёРµ РЅР° СѓСЂРѕРІРЅСЏС… INFO Рё DEBUG
- РћС‚РґРµР»СЊРЅР°СЏ РЅР°СЃС‚СЂРѕР№РєР° РґР»СЏ РїР°РєРµС‚Р° РїСЂРёР»РѕР¶РµРЅРёСЏ
- Р›РѕРіРёСЂРѕРІР°РЅРёРµ SQL Р·Р°РїСЂРѕСЃРѕРІ РІ СЂРµР¶РёРјРµ DEBUG

## Р Р°Р·РІРёС‚РёРµ РїСЂРѕРµРєС‚Р°

Р’РѕР·РјРѕР¶РЅС‹Рµ СѓР»СѓС‡С€РµРЅРёСЏ:
- Р”РѕР±Р°РІР»РµРЅРёРµ С„Р°Р№Р»РѕРІС‹С… РІР»РѕР¶РµРЅРёР№ Рє РєСѓСЂСЃР°Рј
- РЎРёСЃС‚РµРјР° СѓРІРµРґРѕРјР»РµРЅРёР№
- Р Р°СЃС€РёСЂРµРЅРЅР°СЏ Р°РЅР°Р»РёС‚РёРєР° Рё РѕС‚С‡РµС‚С‹
- РРЅС‚РµРіСЂР°С†РёСЏ СЃ РІРЅРµС€РЅРёРјРё LMS СЃРёСЃС‚РµРјР°РјРё
- РљСЌС€РёСЂРѕРІР°РЅРёРµ С‡Р°СЃС‚Рѕ РёСЃРїРѕР»СЊР·СѓРµРјС‹С… РґР°РЅРЅС‹С…
- РџРѕРґРґРµСЂР¶РєР° РјСѓР»СЊС‚РёРјРµРґРёР° РєРѕРЅС‚РµРЅС‚Р°
## Модульная архитектура

- `app` – точка входа, глобальные конфигурации безопасности, OpenAPI и планировщик.
- `common` – общие исключения, DTO ошибок и контракт `common.analytics.VisitTrackingFacade` для обмена доменными событиями.
- `modules/user` – вся работа с учетными записями, безопасность и фасад `UserAccessFacade`, через который другие домены получают пользователей.
- `modules/course` – курсы/уроки и фасад `CourseAccessFacade` для чтения курсов.
- `modules/media` – хранение медиа и работа с файловой системой.
- `modules/quiz` – тесты, попытки, результаты и планировщик очистки.
- `modules/analytics` – посещения, статистика и реализация `VisitTrackingFacade`.

Все зависимости направлены вниз по списку. Доменные классы из верхних уровней доступны только через фасады (`UserAccessFacade`, `CourseAccessFacade`, `VisitTrackingFacade`), поэтому контроллеры и сервисы других модулей не обращаются к чужим репозиториям напрямую.
